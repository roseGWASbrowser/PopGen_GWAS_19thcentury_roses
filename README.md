# PopGenomics & GWAS of the 19th century roses

This repository contains the scripts needed to redo the analyses done by Thibault Leroy et al. (preprint available on bioRxiv) to reconstruct the history of rose breeding during the 19th century, including the analysis of the SNP array dataset, the mapping and SNP calling of the whole-genome sequences, as well as all subsequent analyses and figures. Given the number of analyses performed, some scripts (and more broadly information) could be missing. Please send me an email.

Preprint: Leroy T., Albert E., Thouroude T., Baudino S., Caissard J-C., Chastellier A., Chameau J., Jeauffre J., Loubert T., Paramita S.N., Pernet A., Soufflet-Freslon A., Oghina-Pavie C., Foucher C., Hibrand-Saint Oyant L, Clotault J.
*Dark side of the honeymoon: reconstructing the Asian x European rose breeding history through the lens of genomics*, bioRxiv

Last update: 23/06/23 (in progress) 

### 1/ SNP array dataset (see ./SNParray)

### 2/ Whole-genome sequences (from the raw sequencing to the final SNP set, see ./mapping_calling)

Main softwares: bwa-mem2, picard & GATK4 <br> <br>
A/ First round of calling (see./mapping_calling/1st_round/): <br>
For the reanalysis of publicly available raw sequncing reads, we downloaded the sequences using wget from the SRA archive (e.g. see *script_import_LaFrance.sh*). All other sequences were de novo sequenced and therefore directly downloaded from the sequencing facility. Then, we then used Trimmomatic (e.g. see *script_trimmomatic_LaFrance*). We then used fastqc and multiqc to check the quality of the sequencing data. Then, we used bwa-mem2 to map the paired-end reads, as well as the single-end reads after trimming (see *script_mapping_LaFrance.sh*, note that several samples available from SRA were sequenced with a SE strategy: the botanical roses from Hibrand Saint-Oyant and the Yellow Island cultivar). Mapping results from PE and SE reads were then merged with samtools and picard was then used to remove duplicates. <br>

B/ Second round of calling (see./mapping_calling/1st_round/): <br>
Thanks to this first round of analysis, we were able to generate an extended catalog of SNPs for roses, in oder to perform a BQSR, as well as infer the ploidy level thanks to the data. For this analysis, we only considered 19 non-botanical varieties, also excluding roses with a first-degree relationship (see the analysis of kinship in section 3/).  

### 3/ Population structure, kinship and diversity estimates (see ./popgenomics)

### 4/ GWAS analyses (see ./GWAS)

### 5/ Scripts and files to generate the main figures (see ./main_figures)

The R scripts - as well as the corresponding files containing the results - needed to generate the main figures of the article are made available on this subsection. 

### 6/ Website (see ./website)

This github account hosts the [rose GWAS browser](https://rosegwasbrowser.github.io/)!<br>
The current implementation of the website is based on a series of HTML webpages and a CSS style sheet. The objective of the website was to develop a user-friendly interface to explore the catalog, as a result of the elevated number of Manhattan plots generated (currently available on the website: 84 phenotypes in total * 8 models = 672 circlize plots !). Thanks to different drop-down menus, the user can select several options and the corresponding PDF is then (expected to be) loaded. All the webpages are generated by a single bash script (*script_generate_GWASbrowserwebpages.sh*) made available in the ./website directory (see also: [the roseGWASbrowser github repository](https://github.com/roseGWASbrowser/rosegwasbrowser.github.io).<br>
